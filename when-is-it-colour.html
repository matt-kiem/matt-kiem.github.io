<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Original code from https://github.com/jamlaubro/week-by-week/blob/main/S22023.html -->

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Semester Week</title>

  <style>
    .text {
      color: transparent;
      background-clip: text;
      -webkit-background-clip: text;
      /* background-image: linear-gradient(45deg, rgb(255, 59, 150) 0, rgb(48, 158, 255) 100%); */
    }
  </style>
</head>

<body style="text-align: center;">
  <h2 style="
    padding: 10px 1.6rem; 
    border: 3px solid #2d3b45; 
    display: inline-block; 
    border-radius: 100px; 
    text-align: center; 
    font-family: 'Lato', sans-serif;
    color: #2d3b45;
    font-size: clamp(1.2rem, 2.9vw, 1.4rem);" id="week-display"></h2>
  <script> // [N.B: if you want to change how the box and text looks in terms of styling, do so in the line above]

    const semesterStartDate = new Date("2025-08-04T00:00:00+10:00"); // enter the start date of the Semester in AEDT or AEST

    const weekStartDates = [
      new Date("2025-08-04T00:00:00+10:00"), // enter the start date of Week One
      new Date("2025-08-11T00:00:00+10:00"), // enter the start date of Week Two
      new Date("2025-08-18T00:00:00+10:00"), // enter the start date of Week Three
      new Date("2025-08-25T00:00:00+10:00"), // enter the start date of Week Four
      new Date("2025-09-01T00:00:00+10:00"), // enter the start date of Week Five
      new Date("2025-09-08T00:00:00+10:00"), // enter the start date of Week Six
      new Date("2025-09-15T00:00:00+10:00"), // enter the start date of Week Seven [N.B: the Semester Recess and/or AEDT/AEST may be here too]
      new Date("2025-09-22T00:00:00+10:00"), // enter the start date of Week Eight [N.B: the Semester Recess and/or AEDT/AEST may be here too]
      new Date("2025-09-29T00:00:00+10:00"), // enter the start date of the Semester Recess [N.B: the Semester Recess and/or AEDT/AEST may be here too]
      new Date("2025-10-06T00:00:00+10:00"), // enter the start date of Week Nine [N.B: the Semester Recess and/or AEDT/AEST may be here too]
      new Date("2025-10-13T00:00:00+10:00"), // enter the start date of Week Ten
      new Date("2025-10-20T00:00:00+10:00"), // enter the start date of Week Eleven
      new Date("2025-10-27T00:00:00+10:00"), // enter the start date of Week Twelve
      new Date("2025-11-03T00:00:00+10:00"), // enter the start date of Week Thirteen
      new Date("2025-11-10T00:00:00+10:00"), // enter the start date of STUVAC
      new Date("2025-11-17T00:00:00+10:00"), // enter the start of Week One of the Exam Period
      new Date("2025-11-24T00:00:00+10:00"), // enter the start of Week Two of the Exam Period
      new Date("2025-12-01T00:00:00+10:00"), // enter the start of the following week (i.e. end of the Semester)
    ];

    const getWeekNumber = (date) => {
      
      let weekNumber;
      console.log((date.getTime() - semesterStartDate.getTime()) / 604800000)
      const weeks = Math.floor((date.getTime() - semesterStartDate.getTime()) / 604800000);
      //if(date < weekStartDates[0]) weekNumber = -1; 
      
      for (let i = 0; i < 18; i++) {
        if (date >= weekStartDates[i] && date < weekStartDates[i + 1]) {
          weekNumber = i + 1;
        }
      }
      console.log('weeks',weeks)
      if (weeks < 0) weekNumber = weeks
      if (date >= weekStartDates[17]) weekNumber = 18;
      console.log(weekNumber)
      return weekNumber;
    };

    const getDayName = (dayNumber) => { // [N.B: in HTML format, the first day in the array is Sunday, but the counter will still name it correctly]
      switch (dayNumber) {
        case 0:
          return "Sunday";
        case 1:
          return "Monday";
        case 2:
          return "Tuesday";
        case 3:
          return "Wednesday";
        case 4:
          return "Thursday";
        case 5:
          return "Friday";
        case 6:
          return "Saturday";
      }
    }

    const getWeekName = (weekNumber) => {
      console.log(weekNumber)
      if (weekNumber < 0) {
        return `it is the <span class='text' style='${style}'>${getOrdinalSuffix(weekNumber)} week before Semester</span> â³`;
      } else if (weekNumber >= 18) {
        return `it is <span class='text' style='${style}'>after Semester has finished</span> âŒ›ï¸`;
      } else {
        switch (weekNumber) {
          case 1:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 1</span> ğŸŒ±`;
          case 2:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 2</span> ğŸ“š`;
          case 3:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 3</span> ğŸ§‘â€ğŸ’»`;
          case 4:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 4</span> âœï¸`;
          case 5:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 5</span> ğŸ¯`;
          case 6:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 6</span> ğŸ“Š`;
          case 7:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 7</span> ğŸ”¬`; // depending on when the Semester Recess is, you may need to change the text in the quotation marks
          case 8:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 8</span> ğŸ“`; // depending on when the Semester Recess is, you may need to change the text in the quotation marks
          case 9:
            return `it is <span class='text' style='${style}'> ${dayName} of Mid-semester break</span> ğŸ–`; // depending on when the Semester Recess is, you may need to change the text in the quotation marks
          case 10:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 9</span> ğŸ§‘â€ğŸ«`; // depending on when the Semester Recess is, you may need to change the text in the quotation marks
          case 11:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 10</span> ğŸ«`;
          case 12:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 11</span> ğŸ““`;
          case 13:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 12</span> ğŸ“–`;
          case 14:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 13</span> ğŸŒ»`;
          case 15:
            return `it is <span class='text' style='${style}'> ${dayName} of STUVAC</span> ğŸ“‘`;
          case 16:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 1 of the Exam Period</span> ğŸ’¯`;
          case 17:
            return `it is <span class='text' style='${style}'> ${dayName} of Week 2 of the Exam Period</span> ğŸ’¯`;
        }
      }
    };

    function getOrdinalSuffix(number) {
      const suffixes = ["th", "st", "nd", "rd"];
      const value = Math.abs(number % 100);
      let result = (number * -1) + (suffixes[(value - 20) % 10] || suffixes[value] || suffixes[0])
      if (result === '1st') result = 'last'
      return result;
    }


    const currentDate = new Date(
      new Date().toLocaleString("en-US", { timeZone: "Australia/Sydney" })
    );
    console.log('current date',currentDate)
    const dayNumber = currentDate.getDay();
    const dayName = getDayName(dayNumber);
    const weekNumber = getWeekNumber(currentDate);
    console.log("ğŸ±", dayNumber,dayName, weekNumber)
    let style = 'background-image: linear-gradient(45deg, hsl(340, 100%, 61.57%) 0, hsl(208, 100%, 59.41%) 100%)'
    function colour(num) {
        if (num > 0 && num < 18) {
          const numberToAdd = 20 * num;
          let h1 = 345 + numberToAdd;
          let h2 = 240 + numberToAdd;
          if (h1 > 360) h1 -= 360;
          if (h2 > 360) h2 -= 360;

          function hslToRgb(h, s, l) {
            s /= 100; l /= 100;
            const k = n => (n + h / 30) % 12;
            const a = s * Math.min(l, 1 - l);
            const f = n => l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));
            return [f(0), f(8), f(4)];
          }

          function luminance([r, g, b]) {
            const rgb = [r, g, b].map(v =>
              v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4)
            );
            return 0.2126 * rgb[0] + 0.7152 * rgb[1] + 0.0722 * rgb[2];
          }

          function contrastWithWhite(h, s, l) {
            const lum = luminance(hslToRgb(h, s, l));
            const whiteLum = 1;
            const ratio = (whiteLum + 0.05) / (lum + 0.05);
            return ratio;
          }

          function ensureContrast(h, s, l, minContrast = 4.5) {
            let step = 0;
            let adjustedH = h;
            let adjustedS = s;
            let adjustedL = l;

            while (contrastWithWhite(adjustedH, adjustedS, adjustedL) < minContrast && adjustedL > 0) {
              adjustedL -= 1;               // darken slightly
              adjustedS = Math.min(100, s + step * 0.5); // boost saturation slowly
              adjustedH = (h + step * 0.3) % 360;        // nudge hue slightly as it darkens
              step++;
            }

            return { h: adjustedH, s: adjustedS, l: adjustedL };
          }

          // Adjust both gradient colours to meet contrast threshold
          const c1 = ensureContrast(h1, 100, 45);
          const c2 = ensureContrast(h2, 90, 45);

          style = `background-image: linear-gradient(45deg,
        hsl(${c1.h}, ${c1.s}%, ${c1.l}%) 0,
        hsl(${c2.h}, ${c2.s}%, ${c2.l}%) 100%)`;
        }
      }
    colour(weekNumber)
    const weekName = getWeekName(weekNumber);

    document.getElementById("week-display").innerHTML = "When is it? Right now, " + weekName; // [N.B: if you want to change the text preceding the counter, do so here]
  </script>
</body>

</html>
